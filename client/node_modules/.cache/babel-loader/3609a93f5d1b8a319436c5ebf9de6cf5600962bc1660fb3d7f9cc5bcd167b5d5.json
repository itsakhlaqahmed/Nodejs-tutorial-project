{"ast":null,"code":"import cookie from 'js-cookie';\n\n// set in cookie\nexport const setCookie = (key, value) => {\n  if (window) {\n    cookie.set(key, value, {\n      expires: 1\n    });\n  }\n};\n\n// remove from cookie\nexport const removeCookie = key => {\n  if (window) {\n    cookie.remove(key, {\n      expires: 1\n    });\n  }\n};\n\n// get from cookie such as stored token\n// will be useful when we need to make request to server with token\nexport const getCookie = key => {\n  if (window) {\n    return cookie.get(key);\n  }\n};\n\n// set in local storage\nexport const setLocalStorage = (key, value) => {\n  if (window) {\n    localStorage.setItem(key, JSON.stringify(value));\n  }\n};\n\n// remove from localstorage\nexport const removeLocalStorage = key => {\n  if (window) {\n    localStorage.removeItem(key);\n  }\n};\n\n// authenicate user by passing data to cookie and localstorage during signin\nexport const authenicate = (response, next) => {\n  setCookie('token', response.data.token);\n  setLocalStorage('user', response.data.user);\n  next();\n};\n\n// access user info form localstorage\n\nexport const isAuth = () => {\n  if (window) {\n    const cookieChecked = getCookie('token');\n    if (cookieChecked) {\n      if (localStorage.getItem('user')) {\n        return JSON.parse(localStorage.getItem('user'));\n      }\n    } else {\n      // console.log('not auth')\n      return false;\n    }\n  }\n};\nexport const isAdmin = () => {\n  if (window) {\n    const cookieChecked = getCookie('token');\n    if (cookieChecked) {\n      let user = localStorage.getItem('user');\n      if (user) {\n        console.log(user, user.name, user.role, typeof user.role);\n        return user.role === 'admin' && JSON.parse(user);\n      }\n    } else {\n      return false;\n    }\n  }\n};\nexport const signOut = next => {\n  removeCookie('token');\n  removeLocalStorage('user');\n  next();\n};","map":{"version":3,"names":["cookie","setCookie","key","value","window","set","expires","removeCookie","remove","getCookie","get","setLocalStorage","localStorage","setItem","JSON","stringify","removeLocalStorage","removeItem","authenicate","response","next","data","token","user","isAuth","cookieChecked","getItem","parse","isAdmin","console","log","name","role","signOut"],"sources":["C:/Users/akhla/Documents/Web Development Bootcamp/orielly's mern project/client/src/auth/helper.js"],"sourcesContent":["import cookie from 'js-cookie';\r\n\r\n\r\n// set in cookie\r\nexport const setCookie = (key, value) => {\r\n    if(window){\r\n        cookie.set(key, value,{\r\n            expires: 1\r\n        })\r\n    }\r\n}\r\n\r\n// remove from cookie\r\nexport const removeCookie = (key) => {\r\n    if(window){\r\n        cookie.remove(key, {\r\n            expires: 1\r\n        })\r\n    }\r\n}\r\n\r\n// get from cookie such as stored token\r\n// will be useful when we need to make request to server with token\r\nexport const getCookie = (key) => {\r\n    if(window){\r\n       return cookie.get(key)\r\n    }\r\n}\r\n\r\n\r\n// set in local storage\r\nexport const setLocalStorage = (key, value) => {\r\n    if(window){\r\n        localStorage.setItem(key, JSON.stringify(value))\r\n    }\r\n}\r\n\r\n// remove from localstorage\r\nexport const removeLocalStorage = (key) => {\r\n    if(window){\r\n        localStorage.removeItem(key)\r\n    }\r\n}\r\n\r\n// authenicate user by passing data to cookie and localstorage during signin\r\nexport const authenicate = (response, next) => {\r\n    setCookie('token', response.data.token)\r\n    setLocalStorage('user', response.data.user)\r\n    next();\r\n}\r\n\r\n// access user info form localstorage\r\n\r\nexport const isAuth = () => {\r\n    if(window){\r\n        const cookieChecked = getCookie('token');\r\n        if(cookieChecked){\r\n            if(localStorage.getItem('user')){\r\n                return JSON.parse(localStorage.getItem('user'));\r\n            }\r\n        } else {\r\n            // console.log('not auth')\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\r\nexport const isAdmin = () => {\r\n    if(window){\r\n        const cookieChecked = getCookie('token');\r\n        if(cookieChecked){\r\n            let user = localStorage.getItem('user');\r\n            if(user){\r\n                console.log(user, user.name, user.role, typeof user.role)\r\n                return user.role === 'admin' && JSON.parse(user);\r\n            }\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\r\nexport const signOut = next => {\r\n    removeCookie('token');\r\n    removeLocalStorage('user');\r\n    next();\r\n}"],"mappings":"AAAA,OAAOA,MAAM,MAAM,WAAW;;AAG9B;AACA,OAAO,MAAMC,SAAS,GAAGA,CAACC,GAAG,EAAEC,KAAK,KAAK;EACrC,IAAGC,MAAM,EAAC;IACNJ,MAAM,CAACK,GAAG,CAACH,GAAG,EAAEC,KAAK,EAAC;MAClBG,OAAO,EAAE;IACb,CAAC,CAAC;EACN;AACJ,CAAC;;AAED;AACA,OAAO,MAAMC,YAAY,GAAIL,GAAG,IAAK;EACjC,IAAGE,MAAM,EAAC;IACNJ,MAAM,CAACQ,MAAM,CAACN,GAAG,EAAE;MACfI,OAAO,EAAE;IACb,CAAC,CAAC;EACN;AACJ,CAAC;;AAED;AACA;AACA,OAAO,MAAMG,SAAS,GAAIP,GAAG,IAAK;EAC9B,IAAGE,MAAM,EAAC;IACP,OAAOJ,MAAM,CAACU,GAAG,CAACR,GAAG,CAAC;EACzB;AACJ,CAAC;;AAGD;AACA,OAAO,MAAMS,eAAe,GAAGA,CAACT,GAAG,EAAEC,KAAK,KAAK;EAC3C,IAAGC,MAAM,EAAC;IACNQ,YAAY,CAACC,OAAO,CAACX,GAAG,EAAEY,IAAI,CAACC,SAAS,CAACZ,KAAK,CAAC,CAAC;EACpD;AACJ,CAAC;;AAED;AACA,OAAO,MAAMa,kBAAkB,GAAId,GAAG,IAAK;EACvC,IAAGE,MAAM,EAAC;IACNQ,YAAY,CAACK,UAAU,CAACf,GAAG,CAAC;EAChC;AACJ,CAAC;;AAED;AACA,OAAO,MAAMgB,WAAW,GAAGA,CAACC,QAAQ,EAAEC,IAAI,KAAK;EAC3CnB,SAAS,CAAC,OAAO,EAAEkB,QAAQ,CAACE,IAAI,CAACC,KAAK,CAAC;EACvCX,eAAe,CAAC,MAAM,EAAEQ,QAAQ,CAACE,IAAI,CAACE,IAAI,CAAC;EAC3CH,IAAI,CAAC,CAAC;AACV,CAAC;;AAED;;AAEA,OAAO,MAAMI,MAAM,GAAGA,CAAA,KAAM;EACxB,IAAGpB,MAAM,EAAC;IACN,MAAMqB,aAAa,GAAGhB,SAAS,CAAC,OAAO,CAAC;IACxC,IAAGgB,aAAa,EAAC;MACb,IAAGb,YAAY,CAACc,OAAO,CAAC,MAAM,CAAC,EAAC;QAC5B,OAAOZ,IAAI,CAACa,KAAK,CAACf,YAAY,CAACc,OAAO,CAAC,MAAM,CAAC,CAAC;MACnD;IACJ,CAAC,MAAM;MACH;MACA,OAAO,KAAK;IAChB;EACJ;AACJ,CAAC;AAED,OAAO,MAAME,OAAO,GAAGA,CAAA,KAAM;EACzB,IAAGxB,MAAM,EAAC;IACN,MAAMqB,aAAa,GAAGhB,SAAS,CAAC,OAAO,CAAC;IACxC,IAAGgB,aAAa,EAAC;MACb,IAAIF,IAAI,GAAGX,YAAY,CAACc,OAAO,CAAC,MAAM,CAAC;MACvC,IAAGH,IAAI,EAAC;QACJM,OAAO,CAACC,GAAG,CAACP,IAAI,EAAEA,IAAI,CAACQ,IAAI,EAAER,IAAI,CAACS,IAAI,EAAE,OAAOT,IAAI,CAACS,IAAI,CAAC;QACzD,OAAOT,IAAI,CAACS,IAAI,KAAK,OAAO,IAAIlB,IAAI,CAACa,KAAK,CAACJ,IAAI,CAAC;MACpD;IACJ,CAAC,MAAM;MACH,OAAO,KAAK;IAChB;EACJ;AACJ,CAAC;AAED,OAAO,MAAMU,OAAO,GAAGb,IAAI,IAAI;EAC3Bb,YAAY,CAAC,OAAO,CAAC;EACrBS,kBAAkB,CAAC,MAAM,CAAC;EAC1BI,IAAI,CAAC,CAAC;AACV,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}